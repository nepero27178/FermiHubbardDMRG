\clearpage
\section{Algorithms and simulations}

This section is devoted to delineate the system properties we aim to simulate. The algorithm used is finite-size DMRG, implemented in the \href{https://docs.julialang.org/en/}{\texttt{Julia language}} via the well supported \href{https://itensor.github.io/ITensors.jl/stable/index.html}{\texttt{ITensors.jl}}, \href{https://itensor.github.io/ITensorMPS.jl/stable/}{\texttt{ITensorsMPS.jl}} packages. The hamiltonian of Eq.~\eqref{eq:spinless-hamiltonian-pbc} was simply implemented,

\begin{lstlisting}[language=julia]
function GetHamiltonianMPO(
		sites::Any,		# Sites
		t::Float64,		# Hopping
		V::Float64,		# Interaction
		mu::Float64;	# Chemical pontential
		Phi=0			# Flux
	)::MPO

	os = OpSum()
	L = length(sites)
	
	for j=1:L
		
		# Separate: initialize Float64 or ComplexFloat64 
		if Phi!==0
			os += -t * (cos(Phi/L) - im*sin(Phi/L)),"Cdag",j,"C",mod1(j+1,L)
			os += -t * (cos(Phi/L) + im*sin(Phi/L)),"Cdag",mod1(j+1,L),"C",j
		elseif Phi==0
			os += -t,"Cdag",j,"C",mod1(j+1,L)
			os += -t,"Cdag",mod1(j+1,L),"C",j
		end
		
		os += V,"N",j,"N",mod1(j+1,L)
		os += -mu,"N",j
		
	end
	
	return MPO(os, sites)
end
\end{lstlisting}
I inserted the above snippet to give a feel of the easiness of the packages in Julia language. Finite-size DMRG method is a built-in method in the packages. The entirety of the code, as said, is openly accessible \href{https://github.com/nepero27178/FermiHubbardDMRG}{at this repository}.

\subsection{What I would have liked to do}

A good target is to extract the Bosonization parameters $u$ and $K$ for the spinless Fermi-Hubbard model of Eq.~\eqref{eq:spinless-hamiltonian-pbc}. As said in Sec.~\ref{subsubsec:spinless-fermions-observables}, for a spinless model the task can be easy enough by performing the calculation of the charge compressibility $\kappa$ and the charge stiffness $\mathcal{D}$. From Eq.~\eqref{eq:charge-compressibility} and \eqref{eq:charge-stiffness} respectively,
\begin{equation}\label{eq:charge-compressibility-stiffness-definitions}
	\kappa = \frac{K}{\pi u}
	\qquad\text{and}\qquad
	\mathcal{D} = uK
\end{equation}
which in turn implies
\begin{equation}\label{eq:u-K-formulas}
	u = \sqrt{\frac{\mathcal{D}}{\pi\kappa}}
	\qquad\text{and}\qquad
	K = \sqrt{\pi\kappa\mathcal{D}}
\end{equation}
Coherently with the definitions I used, the observables $\kappa$ and $\mathcal{D}$ were calculated as follows. Let me define:
\begin{equation}\label{eq:fixed-number-energy-definition}
	E_g \left[
		L,N,\eta;\frac{V}{t},\frac{\mu}{t}
	\right]
\end{equation}
as the ground-state energy for the model setup specified by its arguments $L$ (size), $N$ (number of particles), $\eta$ (adimensional magnetic flux) and parameters $V/t$ (reduced NN interaction) and $\mu/t$ (reduced chemical potential). From now on I omit $V/t$ and $\mu/t$ as explicit parameters. 

\paragraph{Charge compressibility.}
Charge compressibility is given by
\[
	\kappa^{-1} = L \pdv[2]{E}{N}
\]
which is well approximated at half-filling by
\begin{equation}\label{eq:charge-compressibility-approximation}
	\kappa_{1/2}(L) \equiv \left[
		\frac{E_g[L,L/2+2,0]+E_g[L,L/2-2,0]-2E_g[L,L/2,0]}{4}
	\right]^{-1}
\end{equation}
(usually one adds or removes $2$ particles in order to avoid even-odd effects). This strategy is good for mapping the compressibility in the canonical ensemble, for which the energy is minimized each time given a fixed particles number. For a mapping of compressibility over the $[V/t,\mu/t]$ evidently one needs to let the particles number vary in order to find the gran-canonical ground state. I adopted a rather rough but coherent strategy, approximated the compressibility via its finite-differences derivative formulation
\[
	\kappa \simeq \frac{\Delta \rho}{\Delta \mu} = \frac{1}{L} \frac{\Delta}{\Delta \mu} \langle \hat N \rangle
\]
where $\langle \hat N \rangle$ is the expected total particles number evaluated at two subsequent simulations with identical $V/t$ and chemical potential differing by $\Delta \mu$.

\paragraph{Charge stiffness.}
Similarly, charge stiffness is given by
\[
	\mathcal{D} = \pi L \pdv[2]{E}{\eta}
\]
which as well is approximated at half filling by
\begin{equation}\label{eq:charge-stiffness-approximation}
	\mathcal{D}_{1/2}(L) \equiv
	\frac{E_g[L,L/2,\delta\eta]+E_g[L,L/2,-\delta\eta]-2E_g[L,L/2,0]}{4(\delta\eta)^2}
\end{equation}
for a ``small'' flux variation $\delta\eta$. It is important to notice here that the charge compressibility is expected to vanish in gapped phases. The reason is simple: if $\partial_\mu \rho=0$, that means that shifting infinitesimally the chemical potential does not increase charge density -- there is no single-particle state that can accommodate additional particles. Thus, there is a gap. A simple and good signal that a phase has become gapless is the non-vanishing charge compressibility.

\subsection{What I actually did}

All I described in the above section is a rather good strategy, provided you can simulate a big long chubby chain with a lot of fermions. It turns out, taken into account my computational resources, the entire strategy turns out to be a little optimistic. It would have been wiser to understand my limits earlier, but that's how life goes, I guess.

\subsubsection*{Charge gaps}

For a model of the class of the spinless Fermi-Hubbard, Eq.~\eqref{eq:spinless-hamiltonian-pbc}, the chemical potential part amounts to a pure energy shift when working inside a fixed-number subspace of the many-body Hilbert space. Let $E_g[L,N,\eta]$ be the ground-state energy of Eq.~\eqref{eq:fixed-number-energy-definition} at fixed particle number $N$. Moreover, let me define
\[
	\Delta_\rho^{\pm M}[\mu] \equiv E_g[L, \rho L \pm M, \eta] - E_g[L, \rho L, \eta]
\]
being $\rho \equiv N/L$ the charge filling and $M \in \mathbb{N}$ a given number of particles ($+$ sign) or holes ($-$ sign) added as elementary excitations. To diagonalize the model \eqref{eq:spinless-hamiltonian-pbc} at fixed particles number means that the energy difference must depend on $\mu/t$ only by the total number of particles, while on $V/t$ in some complicated unspecified way. This implies
\[
	\Delta_\rho^{\pm M}[\mu] \equiv f\left(
		\rho, \frac{V}{t} 
	\right) \mp M \mu
	\quad\implies\quad
	f\left(
		\rho, \frac{V}{t} 
	\right) = \Delta_\rho^{\pm M}[\mu] \pm M\mu
\]
The parametric dependence of the $\Delta$s on $\mu$ was specified explicitly. The left-hand side is independent of $\mu$. Let me define $\mu_\rho^\pm$ as the chemical potential at which the gap closes -- which is, the set of points on the $[V/t,\mu/t]$ plane where to add particles or holes does not cost energy. Then, computing the above equation's right-hand side at zero chemical potential, it must be
\[
	\mu_\rho^{\pm M} = \mp \frac{1}{M} \Delta_\rho^{\pm M}[0]
\]
Now, recall the notation of Fig.~\ref{fig:expected-sfh-phase-diagram}: for the half-filling Mott insulating region, $\mathrm{MI}_{1/2}$, the top and bottom borders shall be given by
\[
	\mu_{1/2}^{\pm 1} = \mp \Delta_{1/2}^{\pm 1}[0]
	\qquad\text{and}\qquad
	\mu_{1/2}^{\pm 2} = \mp \frac{1}{2} \Delta_{1/2}^{\pm 2}[0]
\]
I reported both the expressions for $M=1$ and $M=2$: in our PBC-$\mathrm{XXZ}$ general scheme it is formally more correct to perform fixed-$N$ computations preserving the fermion number parity. For the unitary-filling region, $\mathrm{MI}_1$, of course it is not possible to add particles; as expected, just a $-$ phase boundary can be defined at unitary density
\[
	\mu_1^{-1} = -\Delta_1^{-1}[0]
	\qquad\text{and}\qquad
	\mu_1^{-2} = -\frac{1}{2} \Delta_1^{-2}[0]
\]
To compute $\Delta_\rho^{\pm M}[\mu]$ is just a matter of computing ground-state energies. This procedure allows for a simple estimation of the phase boundaries and, most importantly, provides insight on the finite-size effects.

\begin{figure}
	\centering
	\input{pictures/simulations/phase-boundaries}
	\caption{Estimated position of finite-size chains phase boundaries at increasing lengths. The dashed line on the left delimits the $\mathrm{MI}_1$/$\mathrm{SU}$ phase transition and represents $\mu_1^{-2} |_{@L}$. The solid lines delimit the $\mathrm{MI}_{1/2}$ phase and represent $\mu_{1/2}^{\pm2} |_{@L}$.}
	\label{fig:phase-boundaries}
\end{figure}

A numerical extraction of such phase boundaries was performed for increasing sizes. I used
\[
	L \in \lbrace 14, 22, 30, 38 \rbrace
\]
in order to maintain an odd particles number at half-filling and keep under control computational runtimes. Moreover, I performed the calculation setting $\texttt{double}=\mathrm{true}$ -- which is, adding or removing two particles -- to conserve parity. By direct confrontation of an analogous analysis performed with $\texttt{double}=\mathrm{false}$, no significant difference seems to arise. Results are shown in Fig.~\ref{fig:phase-boundaries}. The $\mathrm{MI}_1$ phase is perfectly coherent with the expectations of Fig.~\ref{fig:expected-sfh-phase-diagram}, while the same is not true for the $\mathrm{MI}_{1/2}$ phase. Increasing lattice length, however, coherence with expectations seems to improve\footnote{
	A straightforward procedure one should carry out at this point should be one Finite-Size-Scaling to estimate the $L \to \infty$ converged phase-boundaries lines. A procedure of this kind I avoid here, but was analogously carried out by Marco Pompili and me on \href{https://github.com/mrc-pop/BoseHubbardDMRG}{our previous work}.
}.

Computationally, this analysis had two purposes. First, detect the finite-size phase transition lines positions without running heavy simulations along the entire parameters space. Secondly and most importantly, using these results, one is able to predict the phase where a given point $(V/t, \mu/t)$ is expected to lie. Now, to simulate Mott-insulating systems requires little computational resources given the simplicity of the ground-state: then, for states expected to be Mott-insulating I have run DMRG algorithms adjusting its simulation parameters to less-expensive configurations without sacrificing accuracy, making use of the rapid convergence times. In DMRG language, I have chosen the following configurations:

\begin{lstlisting}[language=julia]
	#  Ising Ferromagnet (analog) DMRG parameters
	
	IFnSweeps = 5
	IFMaxLinkDim = [10,20,30,40,50]
	IFCutoff = [1E-8]
	
	# Ising Anti-Ferromagnet (analog) DMRG parameters
	
	IAFnSweeps = 5
	IAFMaxLinkDim = [10,20,30,40,50]
	IAFCutoff = [1E-8]
	
	# XY (analog) DMRG paramters
	
	XYnSweeps = 20
	XYMaxLinkDim = [10,50,75,200,500]
	XYCutoff = [1E-8]
\end{lstlisting}

\noindent Notice that, when the length of the \texttt{MaxLinkDim} vector is bigger of the number of sweeps \texttt{nSweeps}, the last value of the \texttt{MaxLinkDim} vector is used \textit{ad libitum}. For the three phases, the \texttt{Cutoff} is set to a generous value and only for the $\mathrm{XY}$ phase there is a significant computational difference both in bond-link dimensions and in the number of DMRG sweeps.

\subsubsection*{Single-point characterization}

A good task is to characterize the three phases by choosing one precise set of parameters representative of each. Each choice $(V/t,\mu/t)$ describes a model whose solution is a given physical phase.

{\color{tabred} [Study of precise states (one for each phase): block density variance, compressibility and charge stiffness, plot of the correlation functions, bipartite entropy.]}

\subsubsection*{Observables heatmaps}
{\color{tabred} [Density heatmap and phase identification.]}